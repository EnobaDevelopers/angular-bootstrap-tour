!function(a){"use strict";function b(a,b){var c=a.$$phase;"$apply"===c||"$digest"===c?b&&"function"==typeof b&&b():a.$apply(b)}function c(a,c,d){c.onShow&&(d.onShow=function(){b(a,function(){a.$eval(c.onShow)})}),c.onShown&&(d.onHide=function(){b(a,function(){a.$eval(c.onShown)})}),c.onHide&&(d.onHide=function(){b(a,function(){a.$eval(c.onHide)})}),c.onHidden&&(d.onHiden=function(){b(a,function(){a.$eval(c.onHiden)})}),c.onNext&&(d.onNext=function(){b(a,function(){a.$eval(c.onNext)})}),c.onPrev&&(d.onPrev=function(){b(a,function(){a.$eval(c.onPrev)})}),c.onPause&&(d.onPause=function(){b(a,function(){a.$eval(c.onPause)})}),c.onResume&&(d.onResume=function(){b(a,function(){a.$eval(c.onResume)})})}a.controller("TourController",["$filter",function(a){function b(b){var c=a("orderBy")(b,"order");return angular.forEach(c,function(a,b){a.next=b+1,a.prev=b-1}),c}function c(){d&&(d._options.steps=[],d.addSteps(b(f)))}var d,e=this,f=[];e.addStep=function(a){~f.indexOf(a)||(f.push(a),c())},e.removeStep=function(a){~f.indexOf(a)&&(f.splice(f.indexOf(a),1),c())},e.getSteps=function(){return f},e.init=function(a){return a.steps=b(f),d=new Tour(a)}}]),a.directive("tour",[function(){return{restrict:"EA",scope:!0,controller:"TourController",link:function(a,d,e,f){var g={name:e.name||"tour",container:e.container||"body",keyboard:e.keyboard||!0,storage:e.storage?a.$eval(e.storage):window.localStorage,debug:e.debug||!1,redirect:e.redirect||!0,duration:e.duration||!1,basePath:e.basePath||"",placement:e.placement||"right",backdrop:e.backdrop||!1,orphan:e.orphan||!1};c(a,e,g),e.onStart&&(g.onStart=function(){b(a,function(){a.$eval(e.onStart)})}),e.onEnd&&(g.onEnd=function(){b(a,function(){a.$eval(e.onEnd)})}),e.afterGetState&&(g.afterGetState=function(c,d){b(a,function(){a.$eval(e.afterGetState).call(a.tour,c,d)})}),e.afterSetState&&(g.afterSetState=function(c,d){b(a,function(){a.$eval(e.afterSetState).call(a.tour,c,d)})}),e.afterRemoveState&&(g.afterRemoveState=function(c,d){b(a,function(){a.$eval(e.afterRemoveState).call(a.tour,c,d)})}),a.$watchCollection(f.getSteps,function(b){a.stepCount=b.length}),e.tourOptions&&angular.extend(g,a.$eval(e.tourOptions)),a.tour=f.init(g)}}}]),a.directive("tourStep",[function(){return{restrict:"EA",scope:!0,require:"^tour",link:function(a,b,d,e){function f(){return d.skip?a.$eval(d.skip):!1}var g={element:b,order:d.order||0};d.placement&&(g.placement=d.placement),d.backdrop&&(g.backdrop=d.backdrop),d.orphan&&(g.orphan=d.orphan),d.reflex&&(g.reflex=d.reflex),c(a,d,g),d.$observe("content",function(a){g.content=a}),d.$observe("title",function(a){g.content=a}),a.$watch(f,function(a){a?e.removeStep(g):e.addStep(g)}),d.options&&angular.extend(g,a.$eval(d.options)),e.addStep(g)}}}])}(angular.module("bm.bsTour",[]));